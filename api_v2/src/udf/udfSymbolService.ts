import localStoreInstance from "../adapters/LocalStoreAdapter";
import { TradeHistory } from "../interfaces/DatafeedUDFCompatibleTradeInterface";
import { SymbolAdapter } from "../adapters/SymbolAdapter";
import {
  UdfErrorResponse,
  UdfSearchSymbolsResponse,
} from "../interfaces/DatafeedUDFCompatibleInterfaces";
import { LibrarySymbolInfo } from "../interfaces/DatafeedInterfaces";

export class UDFSymbolService {
  public symbol_info(): LibrarySymbolInfo {
    let localSymbols = new SymbolAdapter(localStoreInstance.symbols);

    return localSymbols.get_parsed();
  }

  public symbols(search_symbol: string): LibrarySymbolInfo {
    console.log(search_symbol);

    let localSymbols = new SymbolAdapter(localStoreInstance.symbols);
    localSymbols.search_symbols(search_symbol);

    return localSymbols.get_parsed();
  }

  public searchSymbols(
    query: string,
    limit: number,
    type?: string,
    exchange?: string
  ): UdfSearchSymbolsResponse | UdfErrorResponse[] {
    let localSymbols = new SymbolAdapter(localStoreInstance.symbols);
    localSymbols.search_symbols_adv(query, limit, type, exchange);

    return localSymbols.get_searched();
  }

  public history(
    symbol: string,
    from: number,
    to: number,
    resolution: string
  ): TradeHistory {
    console.log("history");
    return {
      s: "ok",
      t: [
        1651795200, 1651881600, 1651968000, 1652054400, 1652140800, 1652227200,
        1652313600, 1652400000, 1652486400, 1652572800, 1652659200, 1652745600,
        1652832000, 1652918400, 1653004800, 1653091200, 1653177600, 1653264000,
        1653350400, 1653436800, 1653523200, 1653609600, 1653696000, 1653782400,
        1653868800, 1653955200, 1654041600, 1654128000, 1654214400, 1654300800,
        1654387200, 1654473600, 1654560000, 1654646400, 1654732800, 1654819200,
        1654905600, 1654992000, 1655078400, 1655164800, 1655251200, 1655337600,
        1655424000, 1655510400, 1655596800, 1655683200, 1655769600, 1655856000,
        1655942400, 1656028800, 1656115200, 1656201600, 1656288000, 1656374400,
        1656460800, 1656547200, 1656633600, 1656720000, 1656806400, 1656892800,
        1656979200, 1657065600, 1657152000, 1657238400, 1657324800, 1657411200,
        1657497600, 1657584000, 1657670400, 1657756800, 1657843200, 1657929600,
        1658016000, 1658102400, 1658188800, 1658275200, 1658361600, 1658448000,
        1658534400, 1658620800, 1658707200, 1658793600, 1658880000, 1658966400,
        1659052800, 1659139200, 1659225600, 1659312000, 1659398400, 1659484800,
        1659571200, 1659657600, 1659744000, 1659830400, 1659916800, 1660003200,
        1660089600, 1660176000, 1660262400, 1660348800, 1660435200, 1660521600,
        1660608000, 1660694400, 1660780800, 1660867200, 1660953600, 1661040000,
        1661126400, 1661212800, 1661299200, 1661385600, 1661472000, 1661558400,
        1661644800, 1661731200, 1661817600, 1661904000, 1661990400, 1662076800,
        1662163200, 1662249600, 1662336000, 1662422400, 1662508800, 1662595200,
        1662681600, 1662768000, 1662854400, 1662940800,
      ],
      c: [
        0.00001948, 0.00001882, 0.00001842, 0.00001663, 0.00001634, 0.00001334,
        0.00001159, 0.0000126, 0.00001392, 0.00001423, 0.00001346, 0.00001397,
        0.00001295, 0.00001283, 0.00001531, 0.00001496, 0.00001486, 0.00001446,
        0.00001451, 0.0000142, 0.00001327, 0.00001285, 0.00001312, 0.00001325,
        0.00001351, 0.00001323, 0.00001341, 0.00001362, 0.00001329, 0.00001322,
        0.00001362, 0.00001366, 0.00001314, 0.00001318, 0.00001306, 0.00001241,
        0.00001169, 0.00001118, 0.00001122, 0.00001136, 0.00001214, 0.00001281,
        0.00001311, 0.00001306, 0.00001285, 0.00001338, 0.0000135, 0.00001353,
        0.00001375, 0.00001423, 0.00001447, 0.000015, 0.00001558, 0.00001566,
        0.00001745, 0.00001655, 0.00001584, 0.00001563, 0.00001538, 0.00001489,
        0.00001494, 0.00001498, 0.00001457, 0.0000147, 0.00001533, 0.00001501,
        0.00001421, 0.0000141, 0.000014, 0.00001412, 0.00001411, 0.00001451,
        0.00001419, 0.0000143, 0.0000142, 0.00001352, 0.00001388, 0.0000137,
        0.00001374, 0.00001363, 0.00001321, 0.00001359, 0.0000134, 0.00001389,
        0.00001394, 0.00001476, 0.00001665, 0.00001557, 0.00001482, 0.00001472,
        0.00001505, 0.00001541, 0.00001537, 0.00001525, 0.00001525, 0.00001486,
        0.00001541, 0.00001571, 0.00001589, 0.00001585, 0.00001539, 0.00001543,
        0.0000152, 0.00001491, 0.00001441, 0.00001451, 0.00001427, 0.00001437,
        0.00001427, 0.00001443, 0.00001446, 0.00001486, 0.00001429, 0.00001482,
        0.00001489, 0.00001505, 0.00001509, 0.00001488, 0.00001476, 0.00001466,
        0.00001478, 0.00001496, 0.00001508, 0.00001452, 0.00001469, 0.00001576,
        0.00001468, 0.00001439, 0.00001438, 0.00001432,
      ],
      o: [
        0.00001961, 0.00001947, 0.00001882, 0.00001843, 0.00001664, 0.00001632,
        0.00001335, 0.00001161, 0.00001253, 0.00001392, 0.00001419, 0.00001347,
        0.00001399, 0.00001296, 0.00001292, 0.0000153, 0.00001497, 0.00001485,
        0.00001435, 0.0000145, 0.0000142, 0.00001327, 0.00001288, 0.00001306,
        0.00001326, 0.00001348, 0.00001324, 0.0000134, 0.00001362, 0.00001329,
        0.00001323, 0.00001361, 0.00001367, 0.00001315, 0.00001317, 0.00001307,
        0.0000124, 0.0000117, 0.00001119, 0.00001123, 0.00001134, 0.00001213,
        0.0000128, 0.0000131, 0.00001307, 0.00001286, 0.00001337, 0.00001351,
        0.00001353, 0.00001375, 0.00001424, 0.00001447, 0.00001502, 0.0000156,
        0.00001564, 0.00001742, 0.00001648, 0.00001586, 0.0000156, 0.00001534,
        0.00001487, 0.00001495, 0.00001498, 0.00001456, 0.00001469, 0.00001531,
        0.00001501, 0.00001419, 0.0000141, 0.00001398, 0.00001412, 0.00001412,
        0.00001452, 0.00001418, 0.00001431, 0.00001421, 0.00001352, 0.00001387,
        0.00001371, 0.00001375, 0.00001364, 0.00001321, 0.00001358, 0.00001341,
        0.0000139, 0.00001395, 0.00001475, 0.00001663, 0.00001557, 0.00001483,
        0.00001473, 0.00001507, 0.00001542, 0.00001537, 0.00001529, 0.00001523,
        0.00001487, 0.00001539, 0.00001569, 0.00001587, 0.00001583, 0.00001541,
        0.00001541, 0.00001517, 0.0000149, 0.0000144, 0.00001452, 0.00001425,
        0.00001437, 0.00001427, 0.00001443, 0.00001446, 0.00001487, 0.00001428,
        0.0000148, 0.00001489, 0.00001506, 0.00001507, 0.00001487, 0.00001476,
        0.00001466, 0.00001479, 0.00001497, 0.00001515, 0.00001453, 0.0000147,
        0.00001574, 0.00001467, 0.00001441, 0.00001436,
      ],
      h: [
        0.00002024, 0.00001996, 0.00001911, 0.00001876, 0.00001762, 0.00001665,
        0.00001368, 0.00001333, 0.00001415, 0.00001466, 0.00001451, 0.00001412,
        0.00001409, 0.00001331, 0.00001608, 0.00001545, 0.00001557, 0.00001715,
        0.00001498, 0.00001451, 0.00001437, 0.00001393, 0.00001353, 0.00001346,
        0.0000136, 0.00001377, 0.00001431, 0.00001392, 0.00001363, 0.0000133,
        0.00001373, 0.00001428, 0.00001367, 0.00001347, 0.00001318, 0.00001309,
        0.00001262, 0.0000117, 0.00001127, 0.00001145, 0.00001232, 0.00001434,
        0.00001326, 0.00001344, 0.00001319, 0.00001391, 0.00001432, 0.00001489,
        0.00001406, 0.00001438, 0.00001468, 0.00001598, 0.00001646, 0.00001644,
        0.00001827, 0.00001773, 0.00001656, 0.00001602, 0.00001574, 0.00001538,
        0.0000154, 0.00001529, 0.00001501, 0.00001607, 0.00001552, 0.00001595,
        0.00001503, 0.00001456, 0.00001442, 0.00001421, 0.00001456, 0.00001472,
        0.00001453, 0.0000146, 0.00001487, 0.00001467, 0.00001399, 0.00001429,
        0.0000139, 0.00001431, 0.00001392, 0.00001364, 0.00001365, 0.00001454,
        0.00001448, 0.00001639, 0.00001759, 0.00001666, 0.00001563, 0.00001507,
        0.00001519, 0.00001547, 0.00001555, 0.00001563, 0.00001572, 0.00001539,
        0.00001542, 0.00001686, 0.00001645, 0.00001607, 0.00001598, 0.00001592,
        0.00001547, 0.00001536, 0.00001535, 0.00001461, 0.00001459, 0.00001456,
        0.00001447, 0.00001475, 0.00001466, 0.00001518, 0.00001494, 0.00001493,
        0.00001503, 0.00001505, 0.00001517, 0.00001519, 0.00001489, 0.00001485,
        0.00001484, 0.0000151, 0.00001523, 0.00001536, 0.00001488, 0.00001583,
        0.00001583, 0.00001497, 0.00001476, 0.00001499,
      ],
      l: [
        0.0000189, 0.00001867, 0.0000181, 0.0000163, 0.00001581, 0.00001261,
        0.00001082, 0.00001139, 0.00001238, 0.00001365, 0.00001318, 0.00001328,
        0.00001286, 0.00001224, 0.00001287, 0.00001432, 0.00001449, 0.00001424,
        0.00001368, 0.00001365, 0.00001302, 0.00001243, 0.00001263, 0.00001285,
        0.00001313, 0.00001297, 0.0000132, 0.00001285, 0.00001301, 0.00001284,
        0.00001289, 0.0000133, 0.00001302, 0.00001302, 0.00001294, 0.00001228,
        0.00001144, 0.00001097, 0.00000999, 0.00001068, 0.00001106, 0.00001211,
        0.00001251, 0.00001256, 0.00001265, 0.00001269, 0.00001321, 0.00001307,
        0.00001348, 0.00001375, 0.00001379, 0.00001423, 0.00001474, 0.00001554,
        0.00001556, 0.00001644, 0.0000155, 0.00001539, 0.00001522, 0.00001485,
        0.00001474, 0.0000148, 0.00001446, 0.00001454, 0.00001465, 0.00001484,
        0.00001407, 0.00001406, 0.00001356, 0.00001373, 0.00001384, 0.00001408,
        0.00001408, 0.00001398, 0.00001407, 0.00001335, 0.00001325, 0.00001336,
        0.00001346, 0.00001354, 0.00001316, 0.00001316, 0.0000131, 0.00001337,
        0.00001365, 0.00001395, 0.00001442, 0.00001538, 0.00001446, 0.00001466,
        0.00001473, 0.00001507, 0.00001529, 0.00001504, 0.00001503, 0.00001467,
        0.00001476, 0.00001515, 0.00001562, 0.00001555, 0.00001524, 0.00001525,
        0.00001503, 0.00001473, 0.00001425, 0.00001395, 0.00001398, 0.00001422,
        0.00001392, 0.00001402, 0.00001426, 0.00001446, 0.00001413, 0.00001422,
        0.00001473, 0.00001462, 0.00001478, 0.00001482, 0.00001449, 0.00001455,
        0.00001458, 0.00001477, 0.00001475, 0.00001442, 0.00001421, 0.0000146,
        0.00001446, 0.00001425, 0.00001412, 0.00001417,
      ],
      v: [
        1259280, 680818, 684175, 1389852, 1249196, 2940981, 7020572, 1673327,
        1965154, 1245929, 1073282, 504800, 692246, 980040, 4590334, 1050360,
        1084551, 1885705, 1459538, 457709, 610693, 1475647, 462595, 437767,
        305461, 728398, 1634050, 1504381, 330574, 330128, 1409478, 1044453,
        301576, 310431, 206488, 301994, 546186, 636207, 2324400, 909693,
        1488177, 4083486, 791231, 1054879, 891823, 1024076, 1453103, 1405483,
        969837, 805624, 704234, 1613931, 1560266, 551146, 2220580, 819275,
        678207, 93076, 118066, 197947, 222119, 103842, 74697, 780281, 266283,
        227065, 312962, 160996, 378729, 204432, 211417, 251054, 81278, 278594,
        809373, 341031, 144256, 303760, 606374, 253145, 283003, 165319, 167800,
        1472216, 592667, 2008806, 2397057, 908970, 426430, 159531, 401455,
        113916, 140726, 152730, 79696, 248271, 527602, 1142678, 1025649, 229496,
        161234, 238022, 189290, 267952, 466728, 226568, 113335, 141476, 137174,
        185795, 70248, 257399, 145076, 133218, 124249, 151960, 231756, 115786,
        61738, 50602, 30950, 65043, 252372, 327544, 117141, 474473, 386102,
        163596, 141967, 312167,
      ],
    };
  }
}
